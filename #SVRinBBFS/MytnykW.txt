Тематический раздел журнала: Системный анализ
УДК 004.855:519.853

О.Ю. Мытник

Построение байесовской регрессии опорных векторов в характеристическом 
пространстве полиномиальных функций Безье-Бернштейна

Ключевые слова: регрессия опорных векторов, байесовское умозаключение, 
полиномы в форме Бернштейна, характеристическое пространство, 
подтверждение.

Key words: support vector regression, Bayesian inference, polynomials 
in Bernstein form, feature space, evidence.


Введение

Метод опорных векторов впервые был предложен В.Н.Вапником для решения 
задач классификации образов [1]. Вскоре этот подход был расширен на 
некорректно поставленные обратные задачи восстановления регрессии по 
данным наблюдений, что привело к появлению регрессии опорных векторов 
(РОВ) [2]. Достаточно полный исторический обзор по алгоритмам опорных 
векторов представлен в работе А.Смолы [3]. Поскольку роизводительность 
РОВ зависит от значений параметров регуляризации (гиперпараметров), 
которые отражают характеристики шума в обучающей выборке, то 
последующие исследования посвящены преимущественно разработке методов 
для определения этих гиперпараметров. Так, М.Лоу и Дж.Квок в своей 
работе [4] применили метод байесовского подтверждения адекватности 
модели РОВ с гиперпараметрами, который был предложен Д.Маккеем [5] для 
регуляризации нейронных сетей. Основным препятствием при использовании 
этого метода есть недифференцируемость #-нечувствительной функции 
потерь. С целью обеспечения требуемого уровня гладкости, как правило, 
предлагается использовать различные приближения, такие как мягкая 
нечувствительная функция потерь [6]. Однако это приводит к нарушению 
свойства робастности РОВ. В настоящей работе предлагается подход, с 
помощью которого можно сохранить робастность и получить простой 
критерий байесовского подтверждения адекватности модели РОВ. Другим 
направлением исследований РОВ есть выбор характеристического 
пространства. Так в работе С.Гунна [7] предложен алгоритм SUPANOVA, 
где характеристическое пространство порождается составляющими 
разложения анализа вариаций (ANOVA). Таким образом, такие преимущества 
ANOVA разложения как структурированное представление зависимостей и их 
интерпретация использованы в РОВ. Дальнейшее развитие разложений на 
основе ANOVA привело к появлению нейронечетких моделей в форме 
Бернштейна [8], которые отличаются способностью интерпретировать 
функциональные зависимости на языке нечеткой логики за счет 
использования базисных полиномов Бернштейна как функций принадлежности. 
Основной задачей данной работы является использование обобщающих 
свойств байесовской модели РОВ с преимуществами представления 
нейронечетких моделей в форме Бернштейна.


Постановка задачи

Пусть исследуемый нелинейный процесс описывается неизвестной скалярной 
функцией #, где #. Допустим, что # принадлежит некоторому семейству 
функций #, которое далее будем называть моделью #, из заданного 
пространства моделей #. Модель #, параметризованная вектором
параметров # и смещением #, имеет вид линейной в параметрах модели:
#,
(1)
где # -- нелинейное отображение пространства входных переменных в 
некоторое характеристическое пространство # размерности # со скалярным 
произведением #. Пространство # также называют пространством признаков 
или спрямляющим пространством, так как задача нелинейной регрессии во 
входном пространстве сводится к линейной в характеристическом. 
Необходимо по данным наблюдений # выбрать адекватную модель # из 
пространства # и найти оценки параметров модели, которые минимизируют 
некоторую меру погрешности между # и #.

Байесовская модель регрессии опорных векторов

Следуя М.Лоу [4] допустим, что распределение шума подчиняется закону:
#,
(2)
где # -- #-нечувствительная функция потерь Вапника: #. Параметры
# и # принято называть гиперпараметрами. Предположим, что шум носит 
аддитивный характер: #, где # -- независимые и одинаково 
распределенные случайные величины. Тогда функция правдоподобия, 
представляющая модель шума, имеет вид:
#
Правдоподобие соответствует вероятности порождения данных # моделью # 
при заданных значениях #, # и #. Зададим априорное распределение
вектора параметров # модели # в виде многомерного нормального 
распределения с нулевым средним и единичной ковариационной матрицей: #.
Байесовское умозаключение для выбора модели из заданного пространства 
моделей и определения ее параметров и гиперпараметров как правило 
рассматривают на трех уровнях.

Байесовское умозаключение 1-го уровня. Оценка параметров

Для модели # с гиперпараметрами # и #, наиболее вероятные значения 
вектора параметров #, находятся из условия максимальности 
апостериорной вероятности параметров, которая согласно теореме Байеса 
равна (знак # -- прямо пропорциональна):
#.
(3)
В противоположном логарифмическом масштабе (3) запишется в виде:
#.
(4)
Тут #. Задача (4) в контексте статистической теории обучения
эквивалентна минимизации функционала регуляризованного риска [3]:
#
Это классическая задача РОВ [2], которую как правило сводят к задаче 
выпуклой оптимизации. При этом находят двойственные переменные #, # 
(множители Лагранжа прямой задачи). Наиболее вероятный вектор 
параметров определяется как линейная комбинация обучающих векторов в
характеристическом пространстве:
#
Одним из простых способов определения смещения модели # является 
решение уравнения # при #. Элементы выборки, которые находятся вне
#-полосы или на ее границах называются опорными векторами. Обозначим 
множество опорных векторов как #. Каждый опорный вектор имеет один
ненулевой множитель Лагранжа, то есть или # или #. Таким образом, 
модель (1) записывается в виде так называемого разложения опорных 
векторов (неопорные векторы имеют # и #, и обнуляют соответствующие 
слагаемые):
#.
(5)
Из разложения (5) легко видеть, что искомая функция может быть 
полностью описана линейной комбинацией разреженной входной выборки в 
характеристическом пространстве.

Байесовское умозаключение 2-го уровня. Оценка гиперпараметров

Рассмотрим теперь каким образом, имея наиболее вероятные вектор 
параметров и смещение модели, можно адекватно скорректировать
значения гиперпараметров # и #. Наиболее вероятные значения 
гиперпараметров находятся из условия максимальности их апостериорной 
плотности вероятности:
#
Величина # называется подтверждением адекватности (или маргинальным 
правдоподобием) модели с гиперпараметрами # и #. Предполагая, что сами
значения гиперпараметров # и # равновероятны, задача сводится к 
максимизации подтверждения #, которое определяется как:
#.
(6)
Подтверждение имеет смысл меры согласия между моделью и данными
наблюдений и является именно той функцией, которую следует 
использовать как предпочтение для тех или иных # и # [9].


Байесовское умозаключение 3-го уровня. Выбор модели

Согласно байесовскому анализу выбирают модель с максимальной
апостериорной вероятностью #. Предполагая равновероятность моделей # в 
пространстве #, выбирают модель с наибольшим подтверждением # равным:
#
В предположении о равновероятности гиперпараметров максимизация
подтверждения # эквивалентна максимизации подтверждения адекватности 
модели с гиперпараметрами (6). Таким образом второй и третий уровни 
байесовского умозаключения вырождаются в один, на котором ищут 
максимум # одновременно и по моделям и по гиперпараметрам. Поскольку в
аналитическом виде функция (6) труднопредставима, то используются 
различные приближения [10]: метод Монте-Карло, метод Лапласа, 
распространение ожиданий. Известно, что метод Лапласа является самым 
быстрым методом приближения и, вместе с тем, он систематически 
переоценивает значение подтверждения. Несмотря на этот недостаток 
метод Лапласа все еще можно использовать при сравнении уровня 
адекватности моделей. Так, используя метод Лапласа, можно показать, 
что подтверждение допускает следующее приближение в окрестности точки 
#:
#,
(7)
где # -- значение гесcиана # регуляризованного риска # в точке #:
#
где # -- единичная матрица размерности #. Наиболее вероятные значения 
гиперпараметров минимизируют приближение (7). Легко видеть, что # 
везде кроме множества критических точек, для которых существует хотя 
бы один элемент выборки, который лежит на верхней или нижней границах
#-полосы: #. В этих точках функция риска недифференцируема. Для того, 
чтобы избежать этой проблемы в [4] предложено приблизить #-
нечувствительную функцию потерь следующей гладкой функцией вида
#,
где #, #. В работе [6] предлагается мягкая нечувствительная функция 
потерь. Но такие подходы приводят как к нарушению робастности моделей 
РОВ так и к сложным интегралам, которые не вычисляются в аналитическом 
виде. В следующем разделе мы покажем каким образом можно обойти 
проблему недостаточной гладкости функции потерь и получить простой 
критерий байесовского подтверждения адекватности моделей.

Критерий байесовского подтверждения адекватности моделей

Лемма (о локальном сглаживании). Для сколь угодно малых #-окрестностей
#, # точек #, # существует такая # гладкая функция, которая совпадает
с #-нечувствительной функцией потерь вне этих окрестностей.

Доказательство этой леммы можно найти в приложении.

Теорема. Для любой #-нечувствительной функции потерь регрессии опорных 
векторов существует сколь угодно малое отклонение #, такое что для #-
нечувствительной функции потерь (#) гесcиан регуляризованного риска # 
тождественно равен # и при этом все элементы выборки сохраняют 
свойства опорности.

Доказательство. Обозначим множество ошибок приближения как #. Если #, 
тогда положим #. Если существует хотя бы одно #, тогда выберем такое 
подмножество ошибок #, для которых #. Очевидно, что существует #. 
Выберем сколь угодно малое значение # из интервала #. Поскольку полоса 
нечувствительности уменьшается (#), то лежавшие на границах #-полосы 
опорные векторы остаются опорными и за пределами #-полосы. Таким 
образом выбранное отклонение # обеспечивает то, что не существует 
элементов выборки, которые лежат на верхней или нижней границах
#-нечувствительной полосы (рис. 1). Отсюда ясно, что #. Выберем #
такое, что #, тогда согласно лемме существует функция #, которая 
совпадает с #-нечувствительной функцией потерь за границами 
окрестностей #. Поскольку не существует точек выборки, которые лежат в 
окрестностях #, а за пределами этих окрестностей вторая производная 
функции потерь равняется нулю, то можно сделать вывод о том, что #.
Отсюда следует, что под общими условиями гесcиан регуляризованного
риска допустимо считать во всех точках характеристического
пространства равным единичной матрице # поскольку для вычислительных 
методов можно пренебречь вариациями ширины полосы нечувствительности в 
пределах вычислительной точности технических средств.

Так как #, то непосредственно Из (7) следует критерий байесовского
подтверждения (КБП) адекватности модели РОВ:
#.
(8)
Наиболее вероятные модель и значения гиперпараметров соответствуют
минимальному значению КБП. В общем случае задача минимизации (8) это 
задача нелинейной оптимизации. Исследуем необходимые условия  
кстремума КБП.

Утверждение. Скорость уменьшения эмпирического риска при увеличении 
ширины полосы нечувствительности прямо пропорциональна количеству 
опорных векторов.

Доказательство. Для начала найдем производную функции потерь Вапника 
по #:
#
В силу теоремы считаем, что #, а значит:
#
где # -- количество опорных векторов.

Взяв производную в (8) относительно гиперпараметра # и приравняв ее 
нулю, получим первое условие:
#.
(9)
Взяв производную в (8) относительно гиперпараметра # и приравняв ее 
нулю, получим второе условие:
#.
(10)
Необходимые условия Экстремума (9-10) приводят в общем случае к 
системе нелинейных алгебраических уравнений (СНАР):
#.
(11)
Вместо минимизации (8) допустимо решать Систему (11), однако это не
гарантирует нахождение глобального минимума. Для решения выше 
указанных задач нелинейной оптимизации можно использовать например
методы простой итерации, Ньютона, Левенберга-Магвердта. Отметим, что
условие (10) имеет также и содержательную интерпретацию. Оно отражает 
априорную вероятность опорности вектора поскольку если настоящий шум 
действительно подчиняется закону (2), тогда вероятность того, что
конкретному # будет отвечать значение выхода # вне #-полосы 
нечувствительности равна:
#
В работе [11] предложен интуитивный метод адаптации гиперпараметров 
РОВ на основе оценивания априорной и апостериорной вероятностей 
опорности векторов. Показана эффективность интуитивного метода на 
примере эталонной модели.

Характеристическое пространство полиномиальных функций
Безье-Бернштейна

Одним из самых важных вопросов при использовании РОВ является вопрос
о выборе характеристического пространства. В работе [3] рассмотрены 
различные типы характеристических пространств, описаны их преимущества 
и недостатки. С целью повышения структурированности байесовской модели
РОВ в настоящей работе в качестве характеристического пространства 
предлагается использовать пространство полиномиальных функций Безье-
Бернштейна, известных также как полиномы в форме Бернштейна. Впервые 
полиномы в форме Бернштейна одной и двух переменных были использованы 
для представления выхода нелинейной системы в виде разложения ANOVA в 
алгоритме построения нейронечетких моделей в форме Бернштейна [8]:
#,
(12)
где вектор входа нелинейной системы #. Для формирования полиномов в
форме Бернштейна одной и двух переменных используются линейные 
комбинации соответствующих базисных полиномов Бернштейна от 
барицентрических координат # и #:
#
где #, #. #, # -- пространства барицентрических координат. Базисные 
полиномы Бернштейна порядка # одной и двух переменных соответственно 
имеют вид:
#.
(13)
Барицентрические координаты в свою очередь вычисляются с помощью 
быстрого обратного алгоритма Кастельжо [12], который реализует 
отображения:
#
Основным преимуществом использования такого подхода является
возможность интерпретации моделей с помощью нечетких правил. При
этом базисные полиномы Бернштейна суть функции принадлежности.
Отметим также, что сложность базы нечетких правил квадратичная, а не
экспонентная как у известного аналога ANFIS.

Определим конфигурацию характеристического пространства # 
полиномиальных функций Безье-Бернштейна как верхнетреугольную матрицу 
# размерности #. Каждый элемент # отображает степень влияния фактора # 
или пары факторов #, # на переменную выхода # и определяет степень 
соответствующего полинома в форме Бернштейна. Определим нелинейное 
отображение # в виде: 
#, при этом #.
Это отображение индуцирует соответствующее пространство моделей в
форме Бернштейна, которое обобщает разложение (12):
#.
(14)

Индуктивный метод построения байесовской модели РОВ в форме Бернштейна

Схема алгоритма ПРИАМ (полиномиальной регрессии индуктивный алгоритм
моделирования), который реализует данный метод имеет вид.

Заданы: пространство моделей в форме Бернштейна #, данные наблюдений #, 
уровень сходимости #, начальная модель #, которая  отвечает априорным 
ожиданиям и существующей информации.
Результат: субоптимальная модель #.
Алгоритм начинает работу с нормировки входного и выходного 
пространств; итератор #;
повторять
#;
генерация множества моделей кандидатов: #, где #, #, # --- нулевая 
матрица с единицей в строке # в столбике #, что соответствует 
минимальному изменению конфигурации пространства;
Для каждой модели кандидата # выполнить
вычисление # с минимизацией (8) по гиперпараметрам;
конец перебора моделей кандидатов;
выбор модели с наименьшим КБП: #;
#;
Пока не выполнится критерий останова: #;
конец работы алгоритма.

Определим размерность задачи обучения размерностью входного 
пространства # и объемом выборки данных наблюдений #. Тогда сложность 
ПРИАМ состоит из перебора моделей кандидатов # и решения задачи 
квадратичного программирования методом активных ограничений # и
определяется как #. Сходимость ПРИАМ обеспечивается глобальной и 
квадратичной сходимостью рефлексивного метода Ньютона для минимизации 
КБП по гиперпараметрам а также, в силу оценки # для #, линейной 
сходимостью поиска субоптимальной модели.


Выводы

Рассмотрена байесовская модель РОВ, основными преимуществами которой
является ее независимость от размерности входного пространства,
решение задачи квадратичного программирования вместо обращения плохо
обусловленных матриц, способность делать статистическое обобщение на
коротких выборках и давать оценки планок погрешностей при 
прогнозировании. Это позволяет восстанавливать зависимости с большим
количеством переменных в условиях ограниченности существующей
информации при сильной мультиколлинеарности и шуме. Локальное 
сглаживание функции потерь значительно упрощает критерий байесовского 
подтверждения адекватности моделей.

Разработан индуктивный метод построения байесовской модели РОВ в
форме Бернштейна, где использованы преимущества как байесовской РОВ
так и нейронечеткого представления в форме Бернштейна. Метод за
полиномиальное время индуцирует структурированные модели с
прозрачными зависимостями, которые легко можно интерпретировать с
помощью нечеткой логики. Имеется возможность задавать априорную
информацию о структуре модели. Практические исследования
предложенного метода (ПРИАМ) на искусственных и реальных эталонных
моделях нелинейной регрессии показывают его высокую продуктивность в
сравнении с работой метода группового учета (МГУА) аргументов в
пакете ``NeuroShell~2'' и рекуррентных нейронных сетей (РНC) в
пакете ``NeuroSolutions~5''. Результаты сравнительного анализа
приведены в табл. 1.

Сравнение нормированной СКО для различных методов

  Модели & Longley & Filippelli & Friedman & AMPG  & ИПЦ   & РПН

  ПРИАМ  & 0.017   & 0.004      & 0.016    & 0.015 & 0.003 & 0.028
  МГУА   & 0.051   & 0.015      & 0.064    & 0.206 & 0.133 & 0.041 
   РНС    & 0.018   & 0.011      & 0.117    & 0.042 & 0.048 & 0.102
   
Как не трудно видеть показатель среднеквадратичной ошибки (СКО)
прогнозирования для алгоритма ПРИАМ в среднем меньше на 50%.
Реальные и искусственные эталонные модели Longley, Filippelli,
Friedman, AMPG можно найти в проекте StRD (Statistical Reference
Datasets: http://www.itl.nist.gov/div898/strd/), который содержит
сертифицированные эталонные модели, в проекте Delve
(http://www.cs.toronto.edu/~delve/) и в базе данных для тестирования
алгоритмов машинного обучения
(http://www.ics.uci.edu/~mlearn/MLRepository.html). Данные по
индексу потребительских цен (ИПЦ) и реальному потреблению населения
(РПН) за 1998-1999~гг предоставлены Госкомстатом Украины.

Приложение

Доказательство леммы о локальном сглаживании. 
Построим такую функцию #, которая совпадает с #-нечувствительной 
функцией потерь вне заданных окрестностей. Поскольку функция потерь 
симметрична, достаточно рассмотреть только неотрицательную 
действительную полуось. Определим везде гладкую первую производную #, 
в виде:
#
где # -- некоторая гладкая функция в окрестности #, то есть на 
интервале #, которая удовлетворяет условиям:
#
где #, # -- производные справа и слева соответственно. Очевидно, что 
таким образом построенная первая производная # обеспечивает # гладкую 
функцию потерь #, которая равна #-нечувствительной функции потерь за 
пределами окрестности # на положительной полуоси. Поэтому для 
доказательства леммы найдем функцию # в классе логистических функций, 
то есть функций вида:
#.
(15)
Очевидно, что для таких функций выполняются условия: #, #. Применим
дробно-линейное преобразование вида
#
для того, чтобы конформно отобразить интервал # на действительную ось
#. Легко убедиться, что отображение # переводит точки #, #, # 
соответственно в точки #, #, #. Это дает возможность записать 
логистическую функцию (15) переменной # в виде:
#.
(16)
В силу антисимметричности этой функции относительно точки #, оценив 
площадь под графиком в #-окрестности, легко видеть, что #. Осталось
проверить значение производных на концах #-окрестности. Производная 
логистической функции:
#
Значение производных на концах соответственно составляют:
#
Таким образом, если выбрать первую производную # с логистической 
функцией # Вида (16), тогда обеспечивается существование
такой функции потерь #, которая совпадает с #-нечувствительной 
функцией потерь вне окрестности # и имеет вид:
#

Список литературы
Boser B.E., Guyon I.M., Vapnik V.N. A training algorithm for optimal
margin classifiers / In: Haussler D. (Ed.), Proceedings of the
Annual Conference on Computational Learning Theory. ACM Press,
Pitts-burgh, PA. -- 1992. -- P. 144--152.

Vapnik V., Golowich S., Smola А. Support vector method for function
approximation, regression estimation, and signal processing
// Advances in Neural Information Processing Systems, Cambridge,
MA. MIT Press. -- 1997. -- Vol. 9. -- P. 281--287.

Smola A.J., Sch#lkopf B. А tutorial on support vector regression // 
Statistics and Computing. -- 2004. -- №14. -- P. 199--222.

Law M.H., Kwok J.T. Applying the Bayesian evidence framework to
#-support vector regression / Proceedings of the European
Conference on Machine Learning (ECML), Freiburg, Germany, September
2001. -- P. 312--323.

Mackay D. A practical Bayesian framework for backprop networks //
Neural Computation. -- 1992. -- Vol. 4. -- P. 448--472.

Chu W., Keerthi S., Ong C. J. Bayesian support vector regression
using a unified loss function // IEEE Transactions on Neural
Networks. -- 2004. -- Vol. 15, №1. -- P. 29--44.

Gunn S.R., Brown M. SUPANOVA -- a sparse, transparent modelling
approach / In Proceedings of IEEE International Workshop on Neural
Networks for Signal Processing, Madison, Wisconsin. -- 1999. -- P.
21--30.

Hong X., Harris C.J. Generalized neurofuzzy network modeling
algorithms using B#zier-Bernstein polynomial functions and
additive decomposition // IEEE Transactions Neural Networks. --
2000. -- Vol. 11, №4. -- P. 889--902.

Mackay D. Bayesian methods for adaptive models. Dissertation.
California Institute of Technology. Pasadena. -- 1992. -- 98 p.

Kuss M., Rasmussen C.E. Assessing approximate inference for binary
gaussian process classification // Journal of Machine Learning
Research. -- 2005. -- №6. -- P. 1679--1704.

Мытник О.Ю. Локальное сглаживание #-нечувствительной функции потерь в 
байесовской модели опорных векторов / Сборник трудов # международной 
научной конференции ``Интеллектуальный анализ информации'', 16 -- 19 
мая 2006 года, г. Київ. -- С. 189--198.

Митник О.Ю., Бідюк П.І. Обернене відображення Кастельжо в нечітких
нейронних моделях // Системні дослідження та інформаційні
технології. -- 2004. -- №2. -- С. 24--34.







Аннотации

Мытник О.Ю. Построение байесовской регрессии опорных векторов в 
характеристическом пространстве полиномиальных функций Безье-
Бернштейна.

Исследуются некорректно поставленные обратные задачи восстановления
нелинейных зависимостей по данным наблюдений с помощью метода опорных 
векторов. Разработан индуктивный метод построения байесовской модели 
регрессии опорных векторов в форме Бернштейна. Для сравнения уровня 
адекватности моделей в форме Бернштейна используется новый критерий 
байесовского подтверждения.


Митник О.Ю. Побудова байєсівської регресії опорних векторів в
характеристичному просторі поліноміальних функцій Без'є-Бернштейна.

Досліджуються некоректно поставлені обернені задачі відновлення
нелінійних залежностей за даними спостережень за допомогою методу
опорних векторів. Розроблено індуктивний метод побудови байєсівської
моделі регресії опорних векторів в формі Бернштейна. Для порівняння
рівня адекватності моделей в формі Бернштейна використовується новий
критерій байєсівського підтвердження.

Mytnyk O.Yu. Construction of Bayesian support vector regression
in feature space spanned by B#zier-Bernstein polynomial functions.

The ill-posed inverse problems for recovery of non-linear dependencies 
based on observational data are under consideration. The inductive 
construction method of Bayesian model of support vector regression in 
Bernstein form is developed. New Bayesian evidence criterion for model 
adequacy comparison is used.


